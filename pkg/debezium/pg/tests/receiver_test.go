package tests

import (
	"fmt"
	"regexp"
	"strings"
	"testing"

	"github.com/doublecloud/transfer/internal/logger"
	"github.com/doublecloud/transfer/library/go/core/xerrors"
	"github.com/doublecloud/transfer/pkg/abstract"
	"github.com/doublecloud/transfer/pkg/debezium"
	debeziumcommon "github.com/doublecloud/transfer/pkg/debezium/common"
	debeziumparameters "github.com/doublecloud/transfer/pkg/debezium/parameters"
	"github.com/doublecloud/transfer/pkg/debezium/typeutil"
	"github.com/stretchr/testify/require"
)

var debeziumMsg = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"int64","optional":true,"field":"val"}],"optional":true,"name":"fullfillment.public.basic_types.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"int64","optional":true,"field":"val"}],"optional":true,"name":"fullfillment.public.basic_types.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false,incremental"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":true,"field":"sequence"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"fullfillment.public.basic_types.Envelope"},"payload":{"before":null,"after":{"id":1,"val":2},"source":{"version":"1.8.0.Final","connector":"postgresql","name":"fullfillment","ts_ms":1643471295802,"snapshot":"false","db":"pguser","sequence":"[\"23725184\",\"23725240\"]","schema":"public","table":"basic_types","txId":555,"lsn":23725240,"xmin":null},"op":"c","ts_ms":1643471296262,"transaction":null}}`

func TestUnmarshalMessage(t *testing.T) {
	result, err := debeziumcommon.UnmarshalMessage(debeziumMsg)
	require.NoError(t, err)
	fmt.Println(result)
}

//---------------------------------------------------------------------------------------------------------------------
// utils

func synthesizeDebeziumMessage(t require.TestingT, changeItem *abstract.ChangeItem) string {
	emitter, err := debezium.NewMessagesEmitter(map[string]string{
		debeziumparameters.DatabaseDBName:   "pguser",
		debeziumparameters.TopicPrefix:      "fullfillment",
		debeziumparameters.AddOriginalTypes: "false",
		debeziumparameters.SourceType:       "pg",
	}, "1.8.0.Final", false, logger.Log)
	require.NoError(t, err)
	result, err := emitter.EmitKV(changeItem, debezium.GetPayloadTSMS(changeItem), false, nil)
	require.NoError(t, err)
	require.Equal(t, len(result), 1)
	return *result[0].DebeziumVal
}

func wipeSequenceAndIncremental(debeziumMsgStr string) string {
	s := debeziumMsgStr
	s = regexp.MustCompile(`,"sequence":"[^]]+]"`).ReplaceAllString(s, ``)
	s = strings.ReplaceAll(s, `{"field":"sequence","optional":true,"type":"string"},`, ``)
	s = strings.ReplaceAll(s, `,incremental`, ``)

	return s
}

func fixTSMS(debeziumMsgStr string) string {
	s := debeziumMsgStr
	s = regexp.MustCompile(`"ts_ms":[0-9]+`).ReplaceAllString(s, `"ts_ms":0`)
	return s
}

func fixCommitTimeAndLSN(debeziumMsgStr string) string {
	s := debeziumMsgStr
	s = regexp.MustCompile(`"commitTime":[0-9]+`).ReplaceAllString(s, `"commitTime":0`)
	s = regexp.MustCompile(`"nextlsn":[0-9]+`).ReplaceAllString(s, `"nextlsn":0`)
	s = strings.ReplaceAll(s, `,"part":""`, ``)
	s = strings.ReplaceAll(s, `,"required":false`, `,"required":true`)
	return s
}

func ReceiveStr(r *debezium.Receiver, in string) (string, error) {
	changeItem, err := r.Receive(in)
	if err != nil {
		return "", xerrors.Errorf("unable to receive, err: %w", err)
	}
	return changeItem.ToJSONString(), err
}

func receiveWrapper(t require.TestingT, debeziumMsg, canonizedChangeItem string, originalTypes map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo) {
	canonDebeziumMsgWithoutSequence := wipeSequenceAndIncremental(debeziumMsg)
	receiver := debezium.NewReceiver(originalTypes, nil)
	changeItemStr, err := ReceiveStr(receiver, canonDebeziumMsgWithoutSequence)
	require.NoError(t, err)
	changeItem, err := abstract.UnmarshalChangeItem([]byte(changeItemStr))
	require.NoError(t, err)
	syntheticRestoredDebezium := synthesizeDebeziumMessage(t, changeItem)
	require.Equal(t, fixCommitTimeAndLSN(canonizedChangeItem), fixCommitTimeAndLSN(changeItemStr))
	require.Equal(t, typeutil.UnescapeUnicode(fixTSMS(canonDebeziumMsgWithoutSequence)), typeutil.UnescapeUnicode(fixTSMS(syntheticRestoredDebezium)))
}

func fixTableName(in string) string {
	s := in
	s = regexp.MustCompile(`basic_types[0-9][0-9]"`).ReplaceAllString(s, `basic_types"`)
	return s
}

//---------------------------------------------------------------------------------------------------------------------

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val bigint);
// INSERT INTO public.basic_types (id, val) VALUES (1, 2);
var debeziumMsg00 = `{"payload":{"after":{"id":1,"val":2},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":23725240,"name":"fullfillment","schema":"public","sequence":"[\\"23725184\\",\\"23725240\\"]","snapshot":"false","table":"basic_types","ts_ms":1643471295802,"txId":555,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643471296262},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"int64"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"int64"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem00 = `{"id":555,"nextlsn":23725240,"commitTime":1643471295802000000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types00","columnnames":["id","val"],"columnvalues":[1,2],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"int64","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:bigint"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive00(t *testing.T) {
	receiveWrapper(t, debeziumMsg00, fixTableName(canonChangeItem00), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:bigint"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val bit(1));
// INSERT INTO public.basic_types (id, val) VALUES (1, b'1');
var debeziumMsg01 = `{"payload":{"after":{"id":1,"val":true},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":23737744,"name":"fullfillment","schema":"public","sequence":"[\\"23737688\\",\\"23737744\\"]","snapshot":"false","table":"basic_types","ts_ms":1643471367220,"txId":558,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643471367288},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"boolean"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"boolean"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem01 = `{"id":558,"nextlsn":24522216,"commitTime":1643471788895334000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types01","columnnames":["id","val"],"columnvalues":[1,"1"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"string","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:bit(1)"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive01(t *testing.T) {
	receiveWrapper(t, debeziumMsg01, fixTableName(canonChangeItem01), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:bit(1)"},
		},
	}) // pg:bit(1) debezium converts to boolean - so, we don't have information - either it was bit(1) or boolean on the source.
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val bit(8));
// INSERT INTO public.basic_types (id, val) VALUES (1, b'10111011');
var debeziumMsg02 = `{"payload":{"after":{"id":1,"val":"uw=="},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":23868184,"name":"fullfillment","schema":"public","sequence":"[\"23868184\",\"23868184\"]","snapshot":"false","table":"basic_types","ts_ms":1643471395280,"txId":561,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643471395355},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.data.Bits","optional":true,"parameters":{"length":"8"},"type":"bytes","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.data.Bits","optional":true,"parameters":{"length":"8"},"type":"bytes","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem02 = `{"id":561,"nextlsn":24522216,"commitTime":1643471788895579000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types02","columnnames":["id","val"],"columnvalues":[1,"10111011"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"string","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:bit(8)"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive02(t *testing.T) {
	receiveWrapper(t, debeziumMsg02, fixTableName(canonChangeItem02), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:bit(8)"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val bit varying(8));
// INSERT INTO public.basic_types (id, val) VALUES (1, b'10111011');
var debeziumMsg03 = `{"payload":{"after":{"id":1,"val":"uw=="},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":24088720,"name":"fullfillment","schema":"public","sequence":"[\"24088720\",\"24088720\"]","snapshot":"false","table":"basic_types","ts_ms":1643633778837,"txId":564,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643633779486},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.data.Bits","optional":true,"parameters":{"length":"8"},"type":"bytes","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.data.Bits","optional":true,"parameters":{"length":"8"},"type":"bytes","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem03 = `{"id":564,"nextlsn":24531320,"commitTime":1643633963155601000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types03","columnnames":["id","val"],"columnvalues":[1,"10111011"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"string","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:bit varying(8)"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive03(t *testing.T) {
	receiveWrapper(t, debeziumMsg03, fixTableName(canonChangeItem03), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:bit varying(8)"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val boolean);
// INSERT INTO public.basic_types (id, val) VALUES (1, true);
var debeziumMsg04 = `{"payload":{"after":{"id":1,"val":true},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":24209576,"name":"fullfillment","schema":"public","sequence":"[\"24209520\",\"24209576\"]","snapshot":"false","table":"basic_types","ts_ms":1643634511251,"txId":567,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643634511784},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"boolean"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"boolean"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem04 = `{"id":567,"nextlsn":24540344,"commitTime":1643634681324924000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types04","columnnames":["id","val"],"columnvalues":[1,true],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"boolean","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:boolean"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive04(t *testing.T) {
	receiveWrapper(t, debeziumMsg04, fixTableName(canonChangeItem04), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:boolean"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val bytea);
// INSERT INTO public.basic_types (id, val) VALUES (1, decode('CAFEBABE', 'hex'));
var debeziumMsg05 = `{"payload":{"after":{"id":1,"val":"yv66vg=="},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":24358936,"name":"fullfillment","schema":"public","sequence":"[\"24358936\",\"24358936\"]","snapshot":"false","table":"basic_types","ts_ms":1643635175600,"txId":570,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643635176057},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"bytes"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"bytes"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem05 = `{"id":570,"nextlsn":24572984,"commitTime":1643634881019849000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types05","columnnames":["id","val"],"columnvalues":[1,"yv66vg=="],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"string","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:bytea"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive05(t *testing.T) {
	receiveWrapper(t, debeziumMsg05, fixTableName(canonChangeItem05), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:bytea"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val character(1));
// INSERT INTO public.basic_types (id, val) VALUES (1, 'z');
var debeziumMsg06 = `{"payload":{"after":{"id":1,"val":"z"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":24483600,"name":"fullfillment","schema":"public","sequence":"[\"24483544\",\"24483600\"]","snapshot":"false","table":"basic_types","ts_ms":1643635383640,"txId":573,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643635384053},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem06 = `{"id":573,"nextlsn":24582008,"commitTime":1643635514020408000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types06","columnnames":["id","val"],"columnvalues":[1,"z"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:character(1)"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive06(t *testing.T) {
	receiveWrapper(t, debeziumMsg06, fixTableName(canonChangeItem06), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:character(1)"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val character(4));
// INSERT INTO public.basic_types (id, val) VALUES (1, 'abcd');
var debeziumMsg07 = `{"payload":{"after":{"id":1,"val":"abcd"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":24594536,"name":"fullfillment","schema":"public","sequence":"[\"24594536\",\"24594536\"]","snapshot":"false","table":"basic_types","ts_ms":1643636799976,"txId":576,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643636800108},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem07 = `{"id":576,"nextlsn":24591032,"commitTime":1643636872675869000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types07","columnnames":["id","val"],"columnvalues":[1,"abcd"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:character(4)"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive07(t *testing.T) {
	receiveWrapper(t, debeziumMsg07, fixTableName(canonChangeItem07), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:character(4)"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val character varying(256));
// INSERT INTO public.basic_types (id, val) VALUES (1, 'blablabla');
var debeziumMsg08 = `{"payload":{"after":{"id":1,"val":"blablabla"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":24708568,"name":"fullfillment","schema":"public","sequence":"[\"24708512\",\"24708568\"]","snapshot":"false","table":"basic_types","ts_ms":1643637018349,"txId":579,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643637018651},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem08 = `{"id":579,"nextlsn":24600872,"commitTime":1643637188079327000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types08","columnnames":["id","val"],"columnvalues":[1,"blablabla"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:character varying(256)"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive08(t *testing.T) {
	receiveWrapper(t, debeziumMsg08, fixTableName(canonChangeItem08), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:character varying(256)"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val cidr);
// INSERT INTO public.basic_types (id, val) VALUES (1, '10.1/16');
var debeziumMsg09 = `{"payload":{"after":{"id":1,"val":"10.1.0.0/16"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":24852568,"name":"fullfillment","schema":"public","sequence":"[\"24852512\",\"24852568\"]","snapshot":"false","table":"basic_types","ts_ms":1643637458256,"txId":582,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643637458555},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem09 = `{"id":582,"nextlsn":24618528,"commitTime":1643637543329859000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types09","columnnames":["id","val"],"columnvalues":[1,"10.1.0.0/16"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:cidr"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive09(t *testing.T) {
	receiveWrapper(t, debeziumMsg09, fixTableName(canonChangeItem09), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:cidr"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val date);
// INSERT INTO public.basic_types (id, val) VALUES (1, 'January 8, 1999');
var debeziumMsg10 = `{"payload":{"after":{"id":1,"val":10599},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":24975832,"name":"fullfillment","schema":"public","sequence":"[\"24975832\",\"24975832\"]","snapshot":"false","table":"basic_types","ts_ms":1643637772033,"txId":585,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643637772336},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.Date","optional":true,"type":"int32","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.Date","optional":true,"type":"int32","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem10 = `{"id":585,"nextlsn":24627552,"commitTime":1643659128505565000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types10","columnnames":["id","val"],"columnvalues":[1,"1999-01-08T00:00:00Z"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:date"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive10(t *testing.T) {
	receiveWrapper(t, debeziumMsg10, fixTableName(canonChangeItem10), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:date"},
		},
	}) // pg:date can't be received correctly from debezium without extra info
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val double precision);
// INSERT INTO public.basic_types (id, val) VALUES (1, 3.14e-100);
var debeziumMsg11 = `{"payload":{"after":{"id":1,"val":3.14e-100},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":25116240,"name":"fullfillment","schema":"public","sequence":"[\"25116184\",\"25116240\"]","snapshot":"false","table":"basic_types","ts_ms":1643660790574,"txId":588,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643660790733},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"double"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"double"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem11 = `{"id":588,"nextlsn":25051056,"commitTime":1643660670442569000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types11","columnnames":["id","val"],"columnvalues":[1,3.14e-100],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"double","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:double precision"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive11(t *testing.T) {
	receiveWrapper(t, debeziumMsg11, fixTableName(canonChangeItem11), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:double precision"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val inet);
// INSERT INTO public.basic_types (id, val) VALUES (1, '192.168.1.5');
var debeziumMsg12 = `{"payload":{"after":{"id":1,"val":"192.168.1.5"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":25264200,"name":"fullfillment","schema":"public","sequence":"[\"25264200\",\"25264200\"]","snapshot":"false","table":"basic_types","ts_ms":1643661524350,"txId":591,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643661524595},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem12 = `{"id":591,"nextlsn":25051056,"commitTime":1643660670210670000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types12","columnnames":["id","val"],"columnvalues":[1,"192.168.1.5/32"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:inet"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive12(t *testing.T) {
	receiveWrapper(t, debeziumMsg12, fixTableName(canonChangeItem12), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:inet"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val int4range);
// INSERT INTO public.basic_types (id, val) VALUES (1, '[3,7)'::int4range);
var debeziumMsg13 = `{"payload":{"after":{"id":1,"val":"[3,7)"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":25412936,"name":"fullfillment","schema":"public","sequence":"[\"25412936\",\"25412936\"]","snapshot":"false","table":"basic_types","ts_ms":1643666022708,"txId":594,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643666022893},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem13 = `{"id":594,"nextlsn":25051056,"commitTime":1643660670248166000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types13","columnnames":["id","val"],"columnvalues":[1,"[3,7)"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:int4range"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive13(t *testing.T) {
	receiveWrapper(t, debeziumMsg13, fixTableName(canonChangeItem13), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:int4range"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val int8range);
// INSERT INTO public.basic_types (id, val) VALUES (1, '[3,7)'::int8range);
var debeziumMsg14 = `{"payload":{"after":{"id":1,"val":"[3,7)"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":25644480,"name":"fullfillment","schema":"public","sequence":"[\"25644480\",\"25644480\"]","snapshot":"false","table":"basic_types","ts_ms":1643666270935,"txId":598,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643666271277},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem14 = `{"id":598,"nextlsn":25051056,"commitTime":1643660670399582000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types14","columnnames":["id","val"],"columnvalues":[1,"[3,7)"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:int8range"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive14(t *testing.T) {
	receiveWrapper(t, debeziumMsg14, fixTableName(canonChangeItem14), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:int8range"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val integer);
// INSERT INTO public.basic_types (id, val) VALUES (1, -8388605);
var debeziumMsg15 = `{"payload":{"after":{"id":1,"val":-8388605},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":25770128,"name":"fullfillment","schema":"public","sequence":"[\"25770072\",\"25770128\"]","snapshot":"false","table":"basic_types","ts_ms":1643666479618,"txId":601,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643666480074},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"int32"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"int32"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem15 = `{"id":601,"nextlsn":25051056,"commitTime":1643660670333075000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types15","columnnames":["id","val"],"columnvalues":[1,-8388605],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"int32","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive15(t *testing.T) {
	receiveWrapper(t, debeziumMsg15, fixTableName(canonChangeItem15), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:integer"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val interval);
// INSERT INTO public.basic_types (id, val) VALUES (1, interval '1 day 01:00:00');
var debeziumMsg16 = `{"payload":{"after":{"id":1,"val":90000000000},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":25868768,"name":"fullfillment","schema":"public","sequence":"[\"25868768\",\"25868768\"]","snapshot":"false","table":"basic_types","ts_ms":1643666651700,"txId":605,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643666651858},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.MicroDuration","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.MicroDuration","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem16 = `{"id":605,"nextlsn":25051056,"commitTime":1643660670310867000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types16","columnnames":["id","val"],"columnvalues":[1,"1 day 01:00:00.000000"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:interval"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive16(t *testing.T) {
	receiveWrapper(t, debeziumMsg16, fixTableName(canonChangeItem16), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:interval"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val json);
// INSERT INTO public.basic_types (id, val) VALUES (1, '{"k1": "v1"}');
var debeziumMsg17 = `{"payload":{"after":{"id":1,"val":"{\"k1\":\"v1\"}"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":26009584,"name":"fullfillment","schema":"public","sequence":"[\"26009584\",\"26009584\"]","snapshot":"false","table":"basic_types","ts_ms":1643669861140,"txId":610,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643669861322},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.data.Json","optional":true,"type":"string","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.data.Json","optional":true,"type":"string","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem17 = `{"id":610,"nextlsn":25051056,"commitTime":1643660670260338000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types17","columnnames":["id","val"],"columnvalues":[1,{"k1":"v1"}],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:json"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive17(t *testing.T) {
	receiveWrapper(t, debeziumMsg17, fixTableName(canonChangeItem17), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:json"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val jsonb);
// INSERT INTO public.basic_types (id, val) VALUES (1, '{"k2": "v2"}');
var debeziumMsg18 = `{"payload":{"after":{"id":1,"val":"{\"k2\":\"v2\"}"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":26194920,"name":"fullfillment","schema":"public","sequence":"[\"26194920\",\"26194920\"]","snapshot":"false","table":"basic_types","ts_ms":1643670300335,"txId":616,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643670300736},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.data.Json","optional":true,"type":"string","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.data.Json","optional":true,"type":"string","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem18 = `{"id":616,"nextlsn":25051056,"commitTime":1643660670307562000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types18","columnnames":["id","val"],"columnvalues":[1,{"k2":"v2"}],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:jsonb"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive18(t *testing.T) {
	receiveWrapper(t, debeziumMsg18, fixTableName(canonChangeItem18), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:jsonb"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val macaddr);
// INSERT INTO public.basic_types (id, val) VALUES (1, '08:00:2b:01:02:03');
var debeziumMsg19 = `{"payload":{"after":{"id":1,"val":"08:00:2b:01:02:03"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":26373168,"name":"fullfillment","schema":"public","sequence":"[\"26373168\",\"26373168\"]","snapshot":"false","table":"basic_types","ts_ms":1643670468486,"txId":620,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643670468566},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem19 = `{"id":620,"nextlsn":25051056,"commitTime":1643660670399509000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types19","columnnames":["id","val"],"columnvalues":[1,"08:00:2b:01:02:03"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:macaddr"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive19(t *testing.T) {
	receiveWrapper(t, debeziumMsg19, fixTableName(canonChangeItem19), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:macaddr"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val money);
// INSERT INTO public.basic_types (id, val) VALUES (1, 99.98);
var debeziumMsg20 = `{"payload":{"after":{"id":1,"val":"Jw4="},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":26393328,"name":"fullfillment","schema":"public","sequence":"[\"26393272\",\"26393328\"]","snapshot":"false","table":"basic_types","ts_ms":1643670557369,"txId":623,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643670557677},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"org.apache.kafka.connect.data.Decimal","optional":true,"parameters":{"scale":"2"},"type":"bytes","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"org.apache.kafka.connect.data.Decimal","optional":true,"parameters":{"scale":"2"},"type":"bytes","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem20 = `{"id":623,"nextlsn":25051056,"commitTime":1643660670347491000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types20","columnnames":["id","val"],"columnvalues":[1,"$99.98"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:money"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive20(t *testing.T) {
	receiveWrapper(t, debeziumMsg20, fixTableName(canonChangeItem20), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:money"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val numeric(18,2));
// INSERT INTO public.basic_types (id, val) VALUES (1, -100.00);
var debeziumMsg202 = `{"payload":{"after":{"id":1,"val":"2PA="},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":26393328,"name":"fullfillment","schema":"public","sequence":"[\"26393272\",\"26393328\"]","snapshot":"false","table":"basic_types","ts_ms":1643670557369,"txId":623,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643670557677},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"org.apache.kafka.connect.data.Decimal","optional":true,"parameters":{"connect.decimal.precision":"18","scale":"2"},"type":"bytes","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"org.apache.kafka.connect.data.Decimal","optional":true,"parameters":{"connect.decimal.precision":"18","scale":"2"},"type":"bytes","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem202 = `{"id":623,"nextlsn":25051056,"commitTime":1643660670347491000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types20","columnnames":["id","val"],"columnvalues":[1,-100.00],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"double","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:numeric(18,2)"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive202(t *testing.T) {
	receiveWrapper(t, debeziumMsg202, fixTableName(canonChangeItem202), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:numeric(18,2)"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val numeric);
// INSERT INTO public.basic_types (id, val) VALUES (1, 1267650600228229401496703205376);
var debeziumMsg21 = `{"payload":{"after":{"id":1,"val":{"scale":0,"value":"EAAAAAAAAAAAAAAAAA=="}},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":26550024,"name":"fullfillment","schema":"public","sequence":"[\"26549968\",\"26550024\"]","snapshot":"false","table":"basic_types","ts_ms":1643736695780,"txId":626,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643736696145},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"doc":"Variable scaled decimal","field":"val","fields":[{"field":"scale","optional":false,"type":"int32"},{"field":"value","optional":false,"type":"bytes"}],"name":"io.debezium.data.VariableScaleDecimal","optional":true,"type":"struct","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"doc":"Variable scaled decimal","field":"val","fields":[{"field":"scale","optional":false,"type":"int32"},{"field":"value","optional":false,"type":"bytes"}],"name":"io.debezium.data.VariableScaleDecimal","optional":true,"type":"struct","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem21 = `{"id":626,"nextlsn":25051056,"commitTime":1643749932407187000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types21","columnnames":["id","val"],"columnvalues":[1,1267650600228229401496703205376e0],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"double","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:numeric"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive21(t *testing.T) {
	receiveWrapper(t, debeziumMsg21, fixTableName(canonChangeItem21), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:numeric"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val numrange);
// INSERT INTO public.basic_types (id, val) VALUES (1, numrange(1.9,1.91));
var debeziumMsg22 = `{"payload":{"after":{"id":1,"val":"[1.9,1.91)"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":26697384,"name":"fullfillment","schema":"public","sequence":"[\"26697328\",\"26697384\"]","snapshot":"false","table":"basic_types","ts_ms":1643750902810,"txId":629,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643750903030},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem22 = `{"id":629,"nextlsn":25051056,"commitTime":1643749932437964000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types22","columnnames":["id","val"],"columnvalues":[1,"[19e-1,191e-2)"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:numrange"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive22(t *testing.T) {
	receiveWrapper(t, debeziumMsg22, fixTableName(canonChangeItem22), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:numrange"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val oid);
// INSERT INTO public.basic_types (id, val) VALUES (1, 2);
var debeziumMsg23 = `{"payload":{"after":{"id":1,"val":2},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":26925136,"name":"fullfillment","schema":"public","sequence":"[\"26925136\",\"26925136\"]","snapshot":"false","table":"basic_types","ts_ms":1643752629674,"txId":634,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643752629815},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"int64"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"int64"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem23 = `{"id":634,"nextlsn":25051056,"commitTime":1643752954350432000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types23","columnnames":["id","val"],"columnvalues":[1,2],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"int32","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:oid"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive23(t *testing.T) {
	receiveWrapper(t, debeziumMsg23, fixTableName(canonChangeItem23), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:oid"},
		},
	})
}

//	CREATE TABLE public.basic_types (id INT PRIMARY KEY, val point);
//	INSERT INTO public.basic_types (id, val) VALUES (1, point(23.4, -44.5));
//
// timmyb32r: 'wkb' is not supported yet
var debeziumMsg24 = `{"payload":{"after":{"id":1,"val":{"srid":null,"wkb":"","x":23.4,"y":-44.5}},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":27047664,"name":"fullfillment","schema":"public","sequence":"[\"27047608\",\"27047664\"]","snapshot":"false","table":"basic_types","ts_ms":1643753661852,"txId":637,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643753662421},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"doc":"Geometry (POINT)","field":"val","fields":[{"field":"x","optional":false,"type":"double"},{"field":"y","optional":false,"type":"double"},{"field":"wkb","optional":true,"type":"bytes"},{"field":"srid","optional":true,"type":"int32"}],"name":"io.debezium.data.geometry.Point","optional":true,"type":"struct","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"doc":"Geometry (POINT)","field":"val","fields":[{"field":"x","optional":false,"type":"double"},{"field":"y","optional":false,"type":"double"},{"field":"wkb","optional":true,"type":"bytes"},{"field":"srid","optional":true,"type":"int32"}],"name":"io.debezium.data.geometry.Point","optional":true,"type":"struct","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem24 = `{"id":637,"nextlsn":25051056,"commitTime":1643752954586411000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types24","columnnames":["id","val"],"columnvalues":[1,"(23.4,-44.5)"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:point"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive24(t *testing.T) {
	receiveWrapper(t, debeziumMsg24, fixTableName(canonChangeItem24), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:point"},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val citext);
// INSERT INTO public.basic_types (id, val) VALUES (1, 'Tom');
var debeziumMsg25 = `{"payload":{"after":{"id":1,"val":"Tom"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":27710672,"name":"fullfillment","schema":"public","sequence":"[\"27710672\",\"27710672\"]","snapshot":"false","table":"basic_types","ts_ms":1643754482020,"txId":642,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643754482604},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem25 = `{"id":642,"nextlsn":25051056,"commitTime":1643752954420386000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types25","columnnames":["id","val"],"columnvalues":[1,"Tom"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:citext"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive25(t *testing.T) {
	receiveWrapper(t, debeziumMsg25, fixTableName(canonChangeItem25), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:citext`},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val hstore);
// INSERT INTO public.basic_types (id, val) VALUES (1, 'a=>1,b=>2');
var debeziumMsg26 = `{"payload":{"after":{"id":1,"val":"{\"a\":\"1\",\"b\":\"2\"}"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":28360384,"name":"fullfillment","schema":"public","sequence":"[\"28360384\",\"28360384\"]","snapshot":"false","table":"basic_types","ts_ms":1643754993258,"txId":647,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643754993415},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.data.Json","optional":true,"type":"string","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.data.Json","optional":true,"type":"string","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem26 = `{"id":647,"nextlsn":25051056,"commitTime":1643752954509425000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types26","columnnames":["id","val"],"columnvalues":[1,{"a":"1","b":"2"}],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:hstore"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive26(t *testing.T) {
	receiveWrapper(t, debeziumMsg26, fixTableName(canonChangeItem26), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:hstore`},
		},
	})
}

//	CREATE TABLE public.basic_types (id INT PRIMARY KEY, val real);
//	INSERT INTO public.basic_types (id, val) VALUES (1, 1.45e-10);
//
// timmyb32r: in changeItem should be 1.4499999811956599e-10
var debeziumMsg27 = `{"payload":{"after":{"id":1,"val":1.45e-10},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":28500368,"name":"fullfillment","schema":"public","sequence":"[\"28500368\",\"28500368\"]","snapshot":"false","table":"basic_types","ts_ms":1643755417269,"txId":650,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643755417437},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"float"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"float"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem27 = `{"id":650,"nextlsn":25051056,"commitTime":1643752954453055000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types27","columnnames":["id","val"],"columnvalues":[1,1.45e-10],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"double","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:real"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive27(t *testing.T) {
	receiveWrapper(t, debeziumMsg27, fixTableName(canonChangeItem27), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:real`},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val smallint);
// INSERT INTO public.basic_types (id, val) VALUES (1, -32768);
var debeziumMsg28 = `{"payload":{"after":{"id":1,"val":-32768},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":28702048,"name":"fullfillment","schema":"public","sequence":"[\"28701992\",\"28702048\"]","snapshot":"false","table":"basic_types","ts_ms":1643755963173,"txId":654,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643755963263},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"int16"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"int16"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem28 = `{"id":654,"nextlsn":25051056,"commitTime":1643752954579894000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types28","columnnames":["id","val"],"columnvalues":[1,-32768],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"int16","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:smallint"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive28(t *testing.T) {
	receiveWrapper(t, debeziumMsg28, fixTableName(canonChangeItem28), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:smallint`},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val text);
// INSERT INTO public.basic_types (id, val) VALUES (1, 'text_example');
var debeziumMsg29 = `{"payload":{"after":{"id":1,"val":"text_example"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":28856736,"name":"fullfillment","schema":"public","sequence":"[\"28856680\",\"28856736\"]","snapshot":"false","table":"basic_types","ts_ms":1643756263096,"txId":657,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643756263293},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem29 = `{"id":657,"nextlsn":25051056,"commitTime":1643752954596446000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types29","columnnames":["id","val"],"columnvalues":[1,"text_example"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:text"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive29(t *testing.T) {
	receiveWrapper(t, debeziumMsg29, fixTableName(canonChangeItem29), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:text`},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val TIMESTAMP);
// INSERT INTO public.basic_types (id, val) VALUES (1, '2004-10-19 10:23:54');
var debeziumMsg30 = `{"payload":{"after":{"id":1,"val":1098181434000000},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":29001064,"name":"fullfillment","schema":"public","sequence":"[\"29001008\",\"29001064\"]","snapshot":"false","table":"basic_types","ts_ms":1643756441744,"txId":660,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643756441920},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.MicroTimestamp","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.MicroTimestamp","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem30 = `{"id":660,"nextlsn":24668192,"commitTime":1674573416677871000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types00","columnnames":["id","val"],"columnvalues":[1,"2004-10-19T10:23:54+04:00"],"table_schema":[{"table_schema":"public","table_name":"basic_types00","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":true,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types00","path":"","name":"val","type":"timestamp","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:timestamp without time zone"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive30(t *testing.T) {
	z := strings.ReplaceAll(fixTableName(canonChangeItem30), `2004-10-19T10:23:54+04:00`, `2004-10-19T10:23:54Z`)
	receiveWrapper(t, debeziumMsg30, z, map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:timestamp without time zone`},
		},
	})
}

//	CREATE TABLE public.basic_types (id INT PRIMARY KEY, val timestamp with time zone);
//	INSERT INTO public.basic_types (id, val) VALUES (1, '2004-10-19 11:23:54+02');
//
// timmyb32r: data-transfer somewhy reads it with timezone +04
var debeziumMsg31 = `{"payload":{"after":{"id":1,"val":"2004-10-19T09:23:54Z"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":29145752,"name":"fullfillment","schema":"public","sequence":"[\"29145696\",\"29145752\"]","snapshot":"false","table":"basic_types","ts_ms":1643757398858,"txId":663,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643757399293},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.ZonedTimestamp","optional":true,"type":"string","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.ZonedTimestamp","optional":true,"type":"string","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem31 = `{"id":663,"nextlsn":25051056,"commitTime":1643752954549072000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types31","columnnames":["id","val"],"columnvalues":[1,"2004-10-19T09:23:54Z"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:timestamp with time zone"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive31(t *testing.T) {
	receiveWrapper(t, debeziumMsg31, fixTableName(canonChangeItem31), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:timestamp with time zone`},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val time without time zone);
// INSERT INTO public.basic_types (id, val) VALUES (1, '04:05:06');
var debeziumMsg32 = `{"payload":{"after":{"id":1,"val":14706000000},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":29296040,"name":"fullfillment","schema":"public","sequence":"[\"29296040\",\"29296040\"]","snapshot":"false","table":"basic_types","ts_ms":1643758220207,"txId":666,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643758220366},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.MicroTime","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.MicroTime","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem32 = `{"id":666,"nextlsn":24586096,"commitTime":1674763072222677000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types","part":"","columnnames":["id","val"],"columnvalues":[1,"04:05:06"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":true,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:time without time zone"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive32(t *testing.T) {
	receiveWrapper(t, debeziumMsg32, fixTableName(canonChangeItem32), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:time without time zone`},
		},
	})
}

//	CREATE TABLE public.basic_types (id INT PRIMARY KEY, val time with time zone);
//	INSERT INTO public.basic_types (id, val) VALUES (1, '2020-05-26 13:30:25-04');
//
// timmyb32r: : data-transfer somewhy reads it with timezone +04
var debeziumMsg33 = `{"payload":{"after":{"id":1,"val":"17:30:25Z"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":29666752,"name":"fullfillment","schema":"public","sequence":"[\"29666752\",\"29666752\"]","snapshot":"false","table":"basic_types","ts_ms":1643760245348,"txId":676,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643760245457},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.ZonedTime","optional":true,"type":"string","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.ZonedTime","optional":true,"type":"string","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem33 = `{"id":676,"nextlsn":25051056,"commitTime":1643752954618092000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types33","columnnames":["id","val"],"columnvalues":[1,"17:30:25Z"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:time with time zone"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive33(t *testing.T) {
	receiveWrapper(t, debeziumMsg33, fixTableName(canonChangeItem33), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:time with time zone`},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val tsrange);
// INSERT INTO public.basic_types (id, val) VALUES (1, '[2010-01-02 10:00, 2010-01-02 11:00)');
var debeziumMsg34 = `{"payload":{"after":{"id":1,"val":"[\"2010-01-02 10:00:00\",\"2010-01-02 11:00:00\")"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":29895648,"name":"fullfillment","schema":"public","sequence":"[\"29895648\",\"29895648\"]","snapshot":"false","table":"basic_types","ts_ms":1643760870144,"txId":680,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643760870376},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem34 = `{"id":680,"nextlsn":25051056,"commitTime":1643752954611655000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types34","columnnames":["id","val"],"columnvalues":[1,"[2010-01-02 10:00:00,2010-01-02 11:00:00)"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:tsrange"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive34(t *testing.T) {
	receiveWrapper(t, debeziumMsg34, fixTableName(canonChangeItem34), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:tsrange`},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val tstzrange);
// INSERT INTO public.basic_types (id, val) VALUES (1, '[2010-01-01 01:00:00 -05, 2010-01-01 02:00:00 -08)'::tstzrange);
var debeziumMsg35 = `{"payload":{"after":{"id":1,"val":"[\"2010-01-01 06:00:00+00\",\"2010-01-01 10:00:00+00\")"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":30048312,"name":"fullfillment","schema":"public","sequence":"[\"30048312\",\"30048312\"]","snapshot":"false","table":"basic_types","ts_ms":1643763067972,"txId":683,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643763068317},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","optional":true,"type":"string"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem35 = `{"id":683,"nextlsn":25051056,"commitTime":1643752954463913000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types35","columnnames":["id","val"],"columnvalues":[1,"[2010-01-01 06:00:00Z,2010-01-01 10:00:00Z)"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:tstzrange"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive35(t *testing.T) {
	receiveWrapper(t, debeziumMsg35, fixTableName(canonChangeItem35), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:tstzrange`},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val uuid);
// INSERT INTO public.basic_types (id, val) VALUES (1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11');
var debeziumMsg36 = `{"payload":{"after":{"id":1,"val":"a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":29607560,"name":"fullfillment","schema":"public","sequence":"[\"29607504\",\"29607560\"]","snapshot":"false","table":"basic_types","ts_ms":1643759997449,"txId":672,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643759997643},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.data.Uuid","optional":true,"type":"string","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.data.Uuid","optional":true,"type":"string","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem36 = `{"id":672,"nextlsn":25051056,"commitTime":1643752954296104000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types36","columnnames":["id","val"],"columnvalues":[1,"a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:uuid"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive36(t *testing.T) {
	receiveWrapper(t, debeziumMsg36, fixTableName(canonChangeItem36), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:uuid`},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val xml);
// INSERT INTO public.basic_types (id, val) VALUES (1, '<foo>bar</foo>');
var debeziumMsg37 = `{"payload":{"after":{"id":1,"val":"<foo>bar</foo>"},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":29462048,"name":"fullfillment","schema":"public","sequence":"[\"29462048\",\"29462048\"]","snapshot":"false","table":"basic_types","ts_ms":1643759636016,"txId":669,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643759636085},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.data.Xml","optional":true,"type":"string","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.data.Xml","optional":true,"type":"string","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem37 = `{"id":669,"nextlsn":25051056,"commitTime":1643752954400380000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types37","columnnames":["id","val"],"columnvalues":[1,"\u003cfoo\u003ebar\u003c/foo\u003e"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:xml"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive37(t *testing.T) {
	receiveWrapper(t, debeziumMsg37, fixTableName(canonChangeItem37), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:xml`},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val TIME(1));
// INSERT INTO public.basic_types (id, val) VALUES (1, '04:05:06.1');
var debeziumMsg38 = `{"payload":{"after":{"id":1,"val":14706100},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":23831768,"name":"fullfillment","schema":"public","sequence":"[\"23831768\",\"23831768\"]","snapshot":"false","table":"basic_types","ts_ms":1644239926590,"txId":558,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1644239926751},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.Time","optional":true,"type":"int32","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.Time","optional":true,"type":"int32","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem38 = `{"id":558,"nextlsn":24586096,"commitTime":1674764123764984000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types","part":"","columnnames":["id","val"],"columnvalues":[1,"04:05:06.1"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":true,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:time(1) without time zone"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive38(t *testing.T) {
	receiveWrapper(t, debeziumMsg38, fixTableName(canonChangeItem38), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:time(1) without time zone`},
		},
	}) // time(N): 1..3->3, 4..6->6
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val TIME(6));
// INSERT INTO public.basic_types (id, val) VALUES (1, '04:05:06.123456');
var debeziumMsg38_2 = `{"payload":{"after":{"id":1,"val":14706123456},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":34795416,"name":"fullfillment","schema":"public","snapshot":"false","table":"basic_types","ts_ms":1674769011570,"txId":766,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1674769011873},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.MicroTime","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.MicroTime","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem38_2 = `{"id":766,"nextlsn":24586096,"commitTime":1674768915799271000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types33","part":"","columnnames":["id","val"],"columnvalues":[1,"04:05:06.123456"],"table_schema":[{"table_schema":"public","table_name":"basic_types33","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":true,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types33","path":"","name":"val","type":"utf8","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:time(6) without time zone"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive38_2(t *testing.T) {
	receiveWrapper(t, debeziumMsg38_2, fixTableName(canonChangeItem38_2), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:time(6) without time zone`},
		},
	}) // time(N): 1..3->3, 4..6->6
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val TIMESTAMP(1));
// INSERT INTO public.basic_types (id, val) VALUES (1, '2004-10-19 10:23:54.9');
var debeziumMsg39 = `{"payload":{"after":{"id":1,"val":1098181434900},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":23730168,"name":"fullfillment","schema":"public","sequence":"[\"23730168\",\"23730168\"]","snapshot":"false","table":"basic_types","ts_ms":1644243907787,"txId":555,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1644243908374},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.Timestamp","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.Timestamp","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem39 = `{"id":555,"nextlsn":24586096,"commitTime":1674765249216244000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types12","part":"","columnnames":["id","val"],"columnvalues":[1,"2004-10-19T10:23:54.9+04:00"],"table_schema":[{"table_schema":"public","table_name":"basic_types12","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":true,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types12","path":"","name":"val","type":"timestamp","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:timestamp(1) without time zone"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive39(t *testing.T) {
	z := strings.ReplaceAll(fixTableName(canonChangeItem39), `2004-10-19T10:23:54.9+04:00`, `2004-10-19T10:23:54.9Z`)
	receiveWrapper(t, debeziumMsg39, fixTableName(z), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:timestamp(1) without time zone`},
		},
	})
}

//---------------------------------------------------------------------------------------------------------------------

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val TIMESTAMP(1));
// INSERT INTO public.basic_types (id, val) VALUES (1, '2004-10-19 10:23:54.9');
var debeziumMsg41 = `{"payload":{"after":{"id":1,"val":1098181434900},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":24158968,"name":"fullfillment","schema":"public","sequence":"[\"24158912\",\"24158968\"]","snapshot":"false","table":"basic_types","ts_ms":1644247943535,"txId":579,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1644247943618},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.Timestamp","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.Timestamp","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem41 = `{"id":579,"nextlsn":24586096,"commitTime":1674766325363996000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types13","part":"","columnnames":["id","val"],"columnvalues":[1,"2004-10-19T10:23:54.9+04:00"],"table_schema":[{"table_schema":"public","table_name":"basic_types13","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":true,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types13","path":"","name":"val","type":"timestamp","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:timestamp(1) without time zone"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive41(t *testing.T) {
	z := strings.ReplaceAll(fixTableName(canonChangeItem41), `2004-10-19T10:23:54.9+04:00`, `2004-10-19T10:23:54.9Z`)
	receiveWrapper(t, debeziumMsg41, fixTableName(z), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:timestamp(1) without time zone`},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val TIMESTAMP(2));
// INSERT INTO public.basic_types (id, val) VALUES (1, '2004-10-19 10:23:54.98');
var debeziumMsg42 = `{"payload":{"after":{"id":1,"val":1098181434980},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":24171376,"name":"fullfillment","schema":"public","sequence":"[\"24171376\",\"24171376\"]","snapshot":"false","table":"basic_types","ts_ms":1644247978813,"txId":582,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1644247979016},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.Timestamp","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.Timestamp","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem42 = `{"id":582,"nextlsn":24586096,"commitTime":1674766436356239000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types14","part":"","columnnames":["id","val"],"columnvalues":[1,"2004-10-19T10:23:54.98+04:00"],"table_schema":[{"table_schema":"public","table_name":"basic_types14","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":true,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types14","path":"","name":"val","type":"timestamp","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:timestamp(2) without time zone"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive42(t *testing.T) {
	z := strings.ReplaceAll(fixTableName(canonChangeItem42), `2004-10-19T10:23:54.98+04:00`, `2004-10-19T10:23:54.98Z`)
	receiveWrapper(t, debeziumMsg42, fixTableName(z), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:timestamp(2) without time zone`},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val TIMESTAMP(3));
// INSERT INTO public.basic_types (id, val) VALUES (1, '2004-10-19 10:23:54.987');
var debeziumMsg43 = `{"payload":{"after":{"id":1,"val":1098181434987},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":24183824,"name":"fullfillment","schema":"public","sequence":"[\"24183824\",\"24183824\"]","snapshot":"false","table":"basic_types","ts_ms":1644248007860,"txId":585,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1644248008123},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.Timestamp","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.Timestamp","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem43 = `{"id":585,"nextlsn":24586096,"commitTime":1674766569036602000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types15","part":"","columnnames":["id","val"],"columnvalues":[1,"2004-10-19T10:23:54.987+04:00"],"table_schema":[{"table_schema":"public","table_name":"basic_types15","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":true,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types15","path":"","name":"val","type":"timestamp","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:timestamp(3) without time zone"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive43(t *testing.T) {
	z := strings.ReplaceAll(fixTableName(canonChangeItem43), `2004-10-19T10:23:54.987+04:00`, `2004-10-19T10:23:54.987Z`)
	receiveWrapper(t, debeziumMsg43, fixTableName(z), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:timestamp(3) without time zone`},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val TIMESTAMP(4));
// INSERT INTO public.basic_types (id, val) VALUES (1, '2004-10-19 10:23:54.9');
var debeziumMsg44 = `{"payload":{"after":{"id":1,"val":1098181434987600},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":24196216,"name":"fullfillment","schema":"public","sequence":"[\"24196160\",\"24196216\"]","snapshot":"false","table":"basic_types","ts_ms":1644248032513,"txId":588,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1644248032750},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.MicroTimestamp","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.MicroTimestamp","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem44 = `{"id":588,"nextlsn":24586096,"commitTime":1674767015484937000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types20","part":"","columnnames":["id","val"],"columnvalues":[1,"2004-10-19T10:23:54.9+04:00"],"table_schema":[{"table_schema":"public","table_name":"basic_types20","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":true,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types20","path":"","name":"val","type":"timestamp","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:timestamp(4) without time zone"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive44(t *testing.T) {
	z := strings.ReplaceAll(fixTableName(canonChangeItem44), `2004-10-19T10:23:54.9+04:00`, `2004-10-19T10:23:54.9876Z`)
	receiveWrapper(t, debeziumMsg44, fixTableName(z), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:timestamp(4) without time zone`},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val TIMESTAMP(5));
// INSERT INTO public.basic_types (id, val) VALUES (1, '2004-10-19 10:23:54.98765');
var debeziumMsg45 = `{"payload":{"after":{"id":1,"val":1098181434987650},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":24208672,"name":"fullfillment","schema":"public","sequence":"[\"24208616\",\"24208672\"]","snapshot":"false","table":"basic_types","ts_ms":1644248057696,"txId":591,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1644248057828},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.MicroTimestamp","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.MicroTimestamp","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem45 = `{"id":591,"nextlsn":24586096,"commitTime":1674767128031202000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types21","part":"","columnnames":["id","val"],"columnvalues":[1,"2004-10-19T10:23:54.98765+04:00"],"table_schema":[{"table_schema":"public","table_name":"basic_types21","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":true,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types21","path":"","name":"val","type":"timestamp","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:timestamp(5) without time zone"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive45(t *testing.T) {
	z := strings.ReplaceAll(fixTableName(canonChangeItem45), `2004-10-19T10:23:54.98765+04:00`, `2004-10-19T10:23:54.98765Z`)
	receiveWrapper(t, debeziumMsg45, fixTableName(z), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:timestamp(5) without time zone`},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val TIMESTAMP(6));
// INSERT INTO public.basic_types (id, val) VALUES (1, '2004-10-19 10:23:54.987654');
var debeziumMsg46 = `{"payload":{"after":{"id":1,"val":1098181434987654},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":24221064,"name":"fullfillment","schema":"public","sequence":"[\"24221008\",\"24221064\"]","snapshot":"false","table":"basic_types","ts_ms":1644248084027,"txId":594,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1644248084436},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.MicroTimestamp","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.time.MicroTimestamp","optional":true,"type":"int64","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem46 = `{"id":594,"nextlsn":24586096,"commitTime":1674767224153149000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types22","part":"","columnnames":["id","val"],"columnvalues":[1,"2004-10-19T10:23:54.987654+04:00"],"table_schema":[{"table_schema":"public","table_name":"basic_types22","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":true,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types22","path":"","name":"val","type":"timestamp","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:timestamp(6) without time zone"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive46(t *testing.T) {
	z := strings.ReplaceAll(fixTableName(canonChangeItem46), `2004-10-19T10:23:54.987654+04:00`, `2004-10-19T10:23:54.987654Z`)
	receiveWrapper(t, debeziumMsg46, fixTableName(z), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: `pg:timestamp(6) without time zone`},
		},
	})
}

// CREATE TABLE public.basic_types (id INT PRIMARY KEY, val bit varying(16));
// INSERT INTO public.basic_types (id, val) VALUES (1, b'1111111100000000');
var debeziumMsg47 = `{"payload":{"after":{"id":1,"val":"AP8="},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":24088720,"name":"fullfillment","schema":"public","sequence":"[\"24088720\",\"24088720\"]","snapshot":"false","table":"basic_types","ts_ms":1643633778837,"txId":564,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":1643633779486},"schema":{"fields":[{"field":"before","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.data.Bits","optional":true,"parameters":{"length":"16"},"type":"bytes","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"id","optional":false,"type":"int32"},{"field":"val","name":"io.debezium.data.Bits","optional":true,"parameters":{"length":"16"},"type":"bytes","version":1}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false,incremental"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"sequence","optional":true,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItem47 = `{"id":564,"nextlsn":24531320,"commitTime":1643633963155601000,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types03","columnnames":["id","val"],"columnvalues":[1,"1111111100000000"],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"id","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"val","type":"string","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:bit varying(16)"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceive47(t *testing.T) {
	receiveWrapper(t, debeziumMsg47, fixTableName(canonChangeItem47), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"id":  {OriginalType: "pg:integer"},
			"val": {OriginalType: "pg:bit varying(16)"},
		},
	})
}

//---

// create/insert from tests/e2e/pg2pg/all_datatypes_serde_via_debezium_arr
var debeziumMsgArr = `{"payload":{"after":{"arr_bl":[true,true],"arr_c":["1","1"],"arr_character_varying_":["varc","varc"],"arr_d":[3.14e-100,3.14e-100],"arr_date_":[10599,10599],"arr_decimal_":[{"scale":0,"value":"AeJA"},{"scale":0,"value":"AeJA"}],"arr_decimal_5":["MDk=","MDk="],"arr_decimal_5_2":["ME8=","ME8="],"arr_f":[1.45e-10,1.45e-10],"arr_i":[1,1],"arr_id":[1,2],"arr_int":[1,2],"arr_it":["192.168.100.128/25","192.168.100.128/25"],"arr_numeric_":[{"scale":0,"value":"EAAAAAAAAAAAAAAAAA=="},{"scale":14,"value":"EAAAAAAAAAAAAAAAAA=="}],"arr_numeric_5":["MDk=","MDk="],"arr_numeric_5_2":["ME8=","ME8="],"arr_oid_":[1,2],"arr_real_":[1.45e-10,1.45e-10],"arr_si":[1,2],"arr_str":["varchar_example","varchar_example"],"arr_t":["text_example","text_example"],"arr_time1":[14706100000,14706100000],"arr_time6":[14706123000,14706123000],"arr_time_":[14706000000,14706000000],"arr_time_with_time_zone_":["08:51:02Z","08:51:02Z"],"arr_timestamp":[1098181434000000,1098181434000000],"arr_timestamp1":[1098181434900000,1098181434900000],"arr_timestamp6":[1098181434987654,1098181434987654],"arr_timestamptz_":["2004-10-19T08:23:54Z","2004-10-19T08:23:54Z"],"arr_timetz1":["17:30:25Z","17:30:25Z"],"arr_timetz6":["17:30:25Z","17:30:25Z"],"arr_timetz_":["08:51:02Z","08:51:02Z"],"arr_timetz__":["17:30:25Z","17:30:25Z"],"arr_tst":["2004-10-19T09:23:54Z","2004-10-19T09:23:54Z"],"arr_uid":["a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11","a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"],"i":1},"before":null,"op":"c","source":{"connector":"postgresql","db":"pguser","lsn":24544072,"name":"fullfillment","schema":"public","snapshot":"false","table":"basic_types","ts_ms":1652025148443,"txId":0,"version":"1.8.0.Final","xmin":null},"transaction":null,"ts_ms":0},"schema":{"fields":[{"field":"before","fields":[{"field":"i","optional":false,"type":"int32"},{"field":"arr_bl","items":{"optional":true,"type":"boolean"},"optional":true,"type":"array"},{"field":"arr_si","items":{"optional":true,"type":"int16"},"optional":true,"type":"array"},{"field":"arr_int","items":{"optional":true,"type":"int32"},"optional":true,"type":"array"},{"field":"arr_id","items":{"optional":true,"type":"int64"},"optional":true,"type":"array"},{"field":"arr_oid_","items":{"optional":true,"type":"int64"},"optional":true,"type":"array"},{"field":"arr_real_","items":{"optional":true,"type":"float"},"optional":true,"type":"array"},{"field":"arr_d","items":{"optional":true,"type":"double"},"optional":true,"type":"array"},{"field":"arr_c","items":{"optional":true,"type":"string"},"optional":true,"type":"array"},{"field":"arr_str","items":{"optional":true,"type":"string"},"optional":true,"type":"array"},{"field":"arr_character_varying_","items":{"optional":true,"type":"string"},"optional":true,"type":"array"},{"field":"arr_timestamptz_","items":{"name":"io.debezium.time.ZonedTimestamp","optional":true,"type":"string","version":1},"optional":true,"type":"array"},{"field":"arr_tst","items":{"name":"io.debezium.time.ZonedTimestamp","optional":true,"type":"string","version":1},"optional":true,"type":"array"},{"field":"arr_timetz_","items":{"name":"io.debezium.time.ZonedTime","optional":true,"type":"string","version":1},"optional":true,"type":"array"},{"field":"arr_time_with_time_zone_","items":{"name":"io.debezium.time.ZonedTime","optional":true,"type":"string","version":1},"optional":true,"type":"array"},{"field":"arr_uid","items":{"name":"io.debezium.data.Uuid","optional":true,"type":"string","version":1},"optional":true,"type":"array"},{"field":"arr_it","items":{"optional":true,"type":"string"},"optional":true,"type":"array"},{"field":"arr_f","items":{"optional":true,"type":"double"},"optional":true,"type":"array"},{"field":"arr_i","items":{"optional":true,"type":"int32"},"optional":true,"type":"array"},{"field":"arr_t","items":{"optional":true,"type":"string"},"optional":true,"type":"array"},{"field":"arr_date_","items":{"name":"io.debezium.time.Date","optional":true,"type":"int32","version":1},"optional":true,"type":"array"},{"field":"arr_time_","items":{"name":"io.debezium.time.MicroTime","optional":true,"type":"int64","version":1},"optional":true,"type":"array"},{"field":"arr_time1","items":{"name":"io.debezium.time.MicroTime","optional":true,"type":"int64","version":1},"optional":true,"type":"array"},{"field":"arr_time6","items":{"name":"io.debezium.time.MicroTime","optional":true,"type":"int64","version":1},"optional":true,"type":"array"},{"field":"arr_timetz__","items":{"name":"io.debezium.time.ZonedTime","optional":true,"type":"string","version":1},"optional":true,"type":"array"},{"field":"arr_timetz1","items":{"name":"io.debezium.time.ZonedTime","optional":true,"type":"string","version":1},"optional":true,"type":"array"},{"field":"arr_timetz6","items":{"name":"io.debezium.time.ZonedTime","optional":true,"type":"string","version":1},"optional":true,"type":"array"},{"field":"arr_timestamp1","items":{"name":"io.debezium.time.MicroTimestamp","optional":true,"type":"int64","version":1},"optional":true,"type":"array"},{"field":"arr_timestamp6","items":{"name":"io.debezium.time.MicroTimestamp","optional":true,"type":"int64","version":1},"optional":true,"type":"array"},{"field":"arr_timestamp","items":{"name":"io.debezium.time.MicroTimestamp","optional":true,"type":"int64","version":1},"optional":true,"type":"array"},{"field":"arr_numeric_","items":{"doc":"Variable scaled decimal","fields":[{"field":"scale","optional":false,"type":"int32"},{"field":"value","optional":false,"type":"bytes"}],"name":"io.debezium.data.VariableScaleDecimal","optional":true,"type":"struct","version":1},"optional":true,"type":"array"},{"field":"arr_numeric_5","items":{"name":"org.apache.kafka.connect.data.Decimal","optional":true,"parameters":{"connect.decimal.precision":"5","scale":"0"},"type":"bytes","version":1},"optional":true,"type":"array"},{"field":"arr_numeric_5_2","items":{"name":"org.apache.kafka.connect.data.Decimal","optional":true,"parameters":{"connect.decimal.precision":"5","scale":"2"},"type":"bytes","version":1},"optional":true,"type":"array"},{"field":"arr_decimal_","items":{"doc":"Variable scaled decimal","fields":[{"field":"scale","optional":false,"type":"int32"},{"field":"value","optional":false,"type":"bytes"}],"name":"io.debezium.data.VariableScaleDecimal","optional":true,"type":"struct","version":1},"optional":true,"type":"array"},{"field":"arr_decimal_5","items":{"name":"org.apache.kafka.connect.data.Decimal","optional":true,"parameters":{"connect.decimal.precision":"5","scale":"0"},"type":"bytes","version":1},"optional":true,"type":"array"},{"field":"arr_decimal_5_2","items":{"name":"org.apache.kafka.connect.data.Decimal","optional":true,"parameters":{"connect.decimal.precision":"5","scale":"2"},"type":"bytes","version":1},"optional":true,"type":"array"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"after","fields":[{"field":"i","optional":false,"type":"int32"},{"field":"arr_bl","items":{"optional":true,"type":"boolean"},"optional":true,"type":"array"},{"field":"arr_si","items":{"optional":true,"type":"int16"},"optional":true,"type":"array"},{"field":"arr_int","items":{"optional":true,"type":"int32"},"optional":true,"type":"array"},{"field":"arr_id","items":{"optional":true,"type":"int64"},"optional":true,"type":"array"},{"field":"arr_oid_","items":{"optional":true,"type":"int64"},"optional":true,"type":"array"},{"field":"arr_real_","items":{"optional":true,"type":"float"},"optional":true,"type":"array"},{"field":"arr_d","items":{"optional":true,"type":"double"},"optional":true,"type":"array"},{"field":"arr_c","items":{"optional":true,"type":"string"},"optional":true,"type":"array"},{"field":"arr_str","items":{"optional":true,"type":"string"},"optional":true,"type":"array"},{"field":"arr_character_varying_","items":{"optional":true,"type":"string"},"optional":true,"type":"array"},{"field":"arr_timestamptz_","items":{"name":"io.debezium.time.ZonedTimestamp","optional":true,"type":"string","version":1},"optional":true,"type":"array"},{"field":"arr_tst","items":{"name":"io.debezium.time.ZonedTimestamp","optional":true,"type":"string","version":1},"optional":true,"type":"array"},{"field":"arr_timetz_","items":{"name":"io.debezium.time.ZonedTime","optional":true,"type":"string","version":1},"optional":true,"type":"array"},{"field":"arr_time_with_time_zone_","items":{"name":"io.debezium.time.ZonedTime","optional":true,"type":"string","version":1},"optional":true,"type":"array"},{"field":"arr_uid","items":{"name":"io.debezium.data.Uuid","optional":true,"type":"string","version":1},"optional":true,"type":"array"},{"field":"arr_it","items":{"optional":true,"type":"string"},"optional":true,"type":"array"},{"field":"arr_f","items":{"optional":true,"type":"double"},"optional":true,"type":"array"},{"field":"arr_i","items":{"optional":true,"type":"int32"},"optional":true,"type":"array"},{"field":"arr_t","items":{"optional":true,"type":"string"},"optional":true,"type":"array"},{"field":"arr_date_","items":{"name":"io.debezium.time.Date","optional":true,"type":"int32","version":1},"optional":true,"type":"array"},{"field":"arr_time_","items":{"name":"io.debezium.time.MicroTime","optional":true,"type":"int64","version":1},"optional":true,"type":"array"},{"field":"arr_time1","items":{"name":"io.debezium.time.MicroTime","optional":true,"type":"int64","version":1},"optional":true,"type":"array"},{"field":"arr_time6","items":{"name":"io.debezium.time.MicroTime","optional":true,"type":"int64","version":1},"optional":true,"type":"array"},{"field":"arr_timetz__","items":{"name":"io.debezium.time.ZonedTime","optional":true,"type":"string","version":1},"optional":true,"type":"array"},{"field":"arr_timetz1","items":{"name":"io.debezium.time.ZonedTime","optional":true,"type":"string","version":1},"optional":true,"type":"array"},{"field":"arr_timetz6","items":{"name":"io.debezium.time.ZonedTime","optional":true,"type":"string","version":1},"optional":true,"type":"array"},{"field":"arr_timestamp1","items":{"name":"io.debezium.time.MicroTimestamp","optional":true,"type":"int64","version":1},"optional":true,"type":"array"},{"field":"arr_timestamp6","items":{"name":"io.debezium.time.MicroTimestamp","optional":true,"type":"int64","version":1},"optional":true,"type":"array"},{"field":"arr_timestamp","items":{"name":"io.debezium.time.MicroTimestamp","optional":true,"type":"int64","version":1},"optional":true,"type":"array"},{"field":"arr_numeric_","items":{"doc":"Variable scaled decimal","fields":[{"field":"scale","optional":false,"type":"int32"},{"field":"value","optional":false,"type":"bytes"}],"name":"io.debezium.data.VariableScaleDecimal","optional":true,"type":"struct","version":1},"optional":true,"type":"array"},{"field":"arr_numeric_5","items":{"name":"org.apache.kafka.connect.data.Decimal","optional":true,"parameters":{"connect.decimal.precision":"5","scale":"0"},"type":"bytes","version":1},"optional":true,"type":"array"},{"field":"arr_numeric_5_2","items":{"name":"org.apache.kafka.connect.data.Decimal","optional":true,"parameters":{"connect.decimal.precision":"5","scale":"2"},"type":"bytes","version":1},"optional":true,"type":"array"},{"field":"arr_decimal_","items":{"doc":"Variable scaled decimal","fields":[{"field":"scale","optional":false,"type":"int32"},{"field":"value","optional":false,"type":"bytes"}],"name":"io.debezium.data.VariableScaleDecimal","optional":true,"type":"struct","version":1},"optional":true,"type":"array"},{"field":"arr_decimal_5","items":{"name":"org.apache.kafka.connect.data.Decimal","optional":true,"parameters":{"connect.decimal.precision":"5","scale":"0"},"type":"bytes","version":1},"optional":true,"type":"array"},{"field":"arr_decimal_5_2","items":{"name":"org.apache.kafka.connect.data.Decimal","optional":true,"parameters":{"connect.decimal.precision":"5","scale":"2"},"type":"bytes","version":1},"optional":true,"type":"array"}],"name":"fullfillment.public.basic_types.Value","optional":true,"type":"struct"},{"field":"source","fields":[{"field":"version","optional":false,"type":"string"},{"field":"connector","optional":false,"type":"string"},{"field":"name","optional":false,"type":"string"},{"field":"ts_ms","optional":false,"type":"int64"},{"default":"false","field":"snapshot","name":"io.debezium.data.Enum","optional":true,"parameters":{"allowed":"true,last,false"},"type":"string","version":1},{"field":"db","optional":false,"type":"string"},{"field":"table","optional":false,"type":"string"},{"field":"lsn","optional":true,"type":"int64"},{"field":"schema","optional":false,"type":"string"},{"field":"txId","optional":true,"type":"int64"},{"field":"xmin","optional":true,"type":"int64"}],"name":"io.debezium.connector.postgresql.Source","optional":false,"type":"struct"},{"field":"op","optional":false,"type":"string"},{"field":"ts_ms","optional":true,"type":"int64"},{"field":"transaction","fields":[{"field":"id","optional":false,"type":"string"},{"field":"total_order","optional":false,"type":"int64"},{"field":"data_collection_order","optional":false,"type":"int64"}],"optional":true,"type":"struct"}],"name":"fullfillment.public.basic_types.Envelope","optional":false,"type":"struct"}}`
var canonChangeItemArr = `{"id":0,"nextlsn":0,"commitTime":0,"txPosition":0,"kind":"insert","schema":"public","table":"basic_types","columnnames":["i","arr_bl","arr_si","arr_int","arr_id","arr_oid_","arr_real_","arr_d","arr_c","arr_str","arr_character_varying_","arr_timestamptz_","arr_tst","arr_timetz_","arr_time_with_time_zone_","arr_uid","arr_it","arr_f","arr_i","arr_t","arr_date_","arr_time_","arr_time1","arr_time6","arr_timetz__","arr_timetz1","arr_timetz6","arr_timestamp1","arr_timestamp6","arr_timestamp","arr_numeric_","arr_numeric_5","arr_numeric_5_2","arr_decimal_","arr_decimal_5","arr_decimal_5_2"],"columnvalues":[1,[true,true],[1,2],[1,2],[1,2],[1,2],[1.45e-10,1.45e-10],[3.14e-100,3.14e-100],["1","1"],["varchar_example","varchar_example"],["varc","varc"],["2004-10-19T08:23:54Z","2004-10-19T08:23:54Z"],["2004-10-19T09:23:54Z","2004-10-19T09:23:54Z"],["08:51:02Z","08:51:02Z"],["08:51:02Z","08:51:02Z"],["a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11","a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"],["192.168.100.128/25","192.168.100.128/25"],[1.45e-10,1.45e-10],[1,1],["text_example","text_example"],["1999-01-08T00:00:00Z","1999-01-08T00:00:00Z"],["04:05:06.000000","04:05:06.000000"],["04:05:06.100000","04:05:06.100000"],["04:05:06.123000","04:05:06.123000"],["17:30:25Z","17:30:25Z"],["17:30:25Z","17:30:25Z"],["17:30:25Z","17:30:25Z"],["2004-10-19T10:23:54.900000Z","2004-10-19T10:23:54.900000Z"],["2004-10-19T10:23:54.987654Z","2004-10-19T10:23:54.987654Z"],["2004-10-19T10:23:54.000000Z","2004-10-19T10:23:54.000000Z"],[1267650600228229401496703205376e0,12676506002282294.01496703205376e0],["12345","12345"],["123.67","123.67"],[123456e0,123456e0],["12345","12345"],["123.67","123.67"]],"table_schema":[{"table_schema":"public","table_name":"basic_types","path":"","name":"i","type":"int32","key":true,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_bl","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:boolean[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_si","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:smallint[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_int","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_id","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:bigint[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_oid_","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:oid[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_real_","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:real[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_d","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:double precision[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_c","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:character(1)[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_str","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:character varying(256)[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_character_varying_","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:character varying(5)[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_timestamptz_","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:timestamp with time zone[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_tst","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:timestamp with time zone[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_timetz_","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:time with time zone[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_time_with_time_zone_","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:time with time zone[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_uid","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:uuid[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_it","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:inet[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_f","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:double precision[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_i","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:integer[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_t","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:text[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_date_","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:date[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_time_","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:time without time zone[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_time1","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:time(1) without time zone[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_time6","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:time(6) without time zone[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_timetz__","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:time with time zone[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_timetz1","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:time(1) with time zone[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_timetz6","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:time(6) with time zone[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_timestamp1","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:timestamp(1) without time zone[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_timestamp6","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:timestamp(6) without time zone[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_timestamp","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:timestamp without time zone[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_numeric_","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:numeric[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_numeric_5","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:numeric(5,0)[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_numeric_5_2","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:numeric(5,2)[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_decimal_","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:numeric[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_decimal_5","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:numeric(5,0)[]"},{"table_schema":"public","table_name":"basic_types","path":"","name":"arr_decimal_5_2","type":"any","key":false,"fake_key":false,"required":false,"expression":"","original_type":"pg:numeric(5,2)[]"}],"oldkeys":{},"tx_id":"","query":""}`

func TestReceiveArr(t *testing.T) {
	receiveWrapper(t, debeziumMsgArr, fixTableName(canonChangeItemArr), map[abstract.TableID]map[string]*debeziumcommon.OriginalTypeInfo{
		{Namespace: "public", Name: "basic_types"}: {
			"i":                        {OriginalType: "pg:integer"},
			"arr_bl":                   {OriginalType: "pg:boolean[]"},
			"arr_si":                   {OriginalType: "pg:smallint[]"},
			"arr_int":                  {OriginalType: "pg:integer[]"},
			"arr_id":                   {OriginalType: "pg:bigint[]"},
			"arr_oid_":                 {OriginalType: "pg:oid[]"},
			"arr_real_":                {OriginalType: "pg:real[]"},
			"arr_d":                    {OriginalType: "pg:double precision[]"},
			"arr_c":                    {OriginalType: "pg:character[]"},
			"arr_str":                  {OriginalType: "pg:character varying[]"},
			"arr_character_varying_":   {OriginalType: "pg:character varying[]"},
			"arr_timestamptz_":         {OriginalType: "pg:timestamp with time zone[]"},
			"arr_tst":                  {OriginalType: "pg:timestamp with time zone[]"},
			"arr_timetz_":              {OriginalType: "pg:time with time zone[]"},
			"arr_time_with_time_zone_": {OriginalType: "pg:time with time zone[]"},
			"arr_uid":                  {OriginalType: "pg:uuid[]"},
			"arr_it":                   {OriginalType: "pg:inet[]"},
			"arr_f":                    {OriginalType: "pg:double precision[]"},
			"arr_i":                    {OriginalType: "pg:integer[]"},
			"arr_t":                    {OriginalType: "pg:text[]"},
			"arr_date_":                {OriginalType: "pg:date[]"},
			"arr_time_":                {OriginalType: "pg:time without time zone[]"},
			"arr_time1":                {OriginalType: "pg:time(1) without time zone[]"},
			"arr_time6":                {OriginalType: "pg:time(6) without time zone[]"},
			"arr_timetz__":             {OriginalType: "pg:time with time zone[]"},
			"arr_timetz1":              {OriginalType: "pg:time(1) with time zone[]"},
			"arr_timetz6":              {OriginalType: "pg:time(6) with time zone[]"},
			"arr_timestamp1":           {OriginalType: "pg:timestamp(1) without time zone[]"},
			"arr_timestamp6":           {OriginalType: "pg:timestamp(6) without time zone[]"},
			"arr_timestamp":            {OriginalType: "pg:timestamp without time zone[]"},
			"arr_numeric_":             {OriginalType: "pg:numeric[]"},
			"arr_numeric_5":            {OriginalType: "pg:numeric(5,0)[]"},
			"arr_numeric_5_2":          {OriginalType: "pg:numeric(5,2)[]"},
			"arr_decimal_":             {OriginalType: "pg:numeric[]"},
			"arr_decimal_5":            {OriginalType: "pg:numeric(5,0)[]"},
			"arr_decimal_5_2":          {OriginalType: "pg:numeric(5,2)[]"},
		},
	})
}
